---
import MainLayout from "@/layouts/MainLayout.astro";
import Section from "@/components/sections/Section.astro";
import { getLanguageFromPath } from "@/i18n/utils";
import { loadTranslations } from "@/i18n/utils";

const currentPath = Astro.url.pathname;
const language = getLanguageFromPath(currentPath);
const translations = await loadTranslations(language);

const t = (key: string) => {
  const keys = key.split('.');
  let value: any = translations;

  for (const k of keys) {
    if (value && typeof value === 'object' && k in value) {
      value = value[k];
    } else {
      return key;
    }
  }
  
  return typeof value === 'string' ? value : key;
};
---

<MainLayout
  title={`${t('privacy.title')} | IoTRealm`}
  description={t('privacy.description')}
  currentLanguage={language}
  currentPath={currentPath}
>
  <Section id="privacy">
    <div class="container mx-auto px-4 py-16 max-w-4xl terms-container">
      <h1 class="text-4xl font-bold mb-8 text-gray-900">{t('privacy.title')}</h1>

      <div class="prose prose-lg max-w-none">
        <p class="text-gray-600 mb-8">
          {t('privacy.intro')}
        </p>

        <p class="text-sm text-gray-500 mb-8">{t('privacy.establishmentDate')}</p>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section1.title')}</h2>
          <p class="text-gray-700">
            {t('privacy.section1.content')}
          </p>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section2.title')}</h2>
          <p class="text-gray-700 mb-4">{t('privacy.section2.intro')}</p>
          <ul class="list-disc pl-6 space-y-2 text-gray-700">
            {translations.privacy.section2.cases.map((case_: string) => (
              <li>{case_}</li>
            ))}
          </ul>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section3.title')}</h2>
          <p class="text-gray-700 mb-4">
            {t('privacy.section3.intro')}
          </p>
          <ul class="list-disc pl-6 space-y-2 text-gray-700">
            {translations.privacy.section3.dataTypes.map((dataType: string) => (
              <li>{dataType}</li>
            ))}
          </ul>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section4.title')}</h2>
          <p class="text-gray-700 mb-4">
            {t('privacy.section4.intro')}
          </p>
          <ul class="list-disc pl-6 space-y-2 text-gray-700">
            {translations.privacy.section4.purposes.map((purpose: string) => (
              <li>{purpose}</li>
            ))}
          </ul>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section5.title')}</h2>
          <p class="text-gray-700">
            {t('privacy.section5.content')}
          </p>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section6.title')}</h2>
          <p class="text-gray-700">
            {t('privacy.section6.content')}
          </p>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section7.title')}</h2>
          <p class="text-gray-700 mb-4">
            {t('privacy.section7.intro')}
          </p>
          <ul class="list-disc pl-6 space-y-2 text-gray-700">
            {translations.privacy.section7.rights.map((right: string) => (
              <li>{right}</li>
            ))}
          </ul>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section8.title')}</h2>
          <p class="text-gray-700">
            {t('privacy.section8.content')}
          </p>
        </section>

        <section class="mb-8">
          <h2 class="text-2xl font-bold mb-4 text-gray-900">{t('privacy.section9.title')}</h2>
          <p class="text-gray-700">
            {t('privacy.section9.content')}
          </p>
        </section>
      </div>
    </div>
  </Section>
</MainLayout>
